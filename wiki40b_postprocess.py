from collections import Counter
import sys
import pdb
import re
import os
from multiprocessing import Pool

homoglyphs = {
    ' ': ['\xa0', '\u1680', '\u2000', '\u2001', '\u2002', '\u2003', '\u2004', '\u2005', '\u2006', '\u2007', '\u2008', '\u2009', '\u200a', '\u2028', '\u2029', '\u202f', '\u205f'],
    '!': ['Çƒ', 'âµ‘', 'ï¼'],
    '$': ['ï¼„'],
    '%': ['ï¼…'],
    '&': ['ê¸', 'ï¼†'],
    "'": ['Â´', 'Ê¹', 'Ê»', 'Ê¼', 'Ê½', 'Ê¾', 'Ëˆ', 'ËŠ', 'Ë‹', 'Ë´', 'Í´', 'Î„', 'Õš', 'Õ', '×™', '×³', 'ß´', 'ßµ', 'á‘Š', 'á›Œ', 'á¾½', 'á¾¿', 'á¿¯', 'á¿½', 'á¿¾', 'â€˜', 'â€™', 'â€›', 'â€²', 'â€µ', 'êŒ', 'ï¼‡', 'ï½€', 'ğ–½‘', 'ğ–½’'],
    '"': ['Â¨', 'Êº', 'Ë', 'Ë®', '×´', 'â€œ', 'â€', 'â€Ÿ', 'â', 'â', 'â ', 'â¹‚'],
    '(': ['â¨', 'â²', 'ã€”', 'ï´¾', 'ï¼ˆ', 'ï¼»'],
    ')': ['â©', 'â³', 'ã€•', 'ï´¿', 'ï¼‰', 'ï¼½'],
    '*': ['Ù­', 'â', 'âˆ—', 'ï¼Š', 'ğŒŸ'],
    '+': ['á›­', 'â•', 'ï¼‹', 'ğŠ›'],
    ',': ['Â¸', 'Ø', 'Ù«', 'â€š', 'ê“¹', 'ï¼Œ'],
    '-': ['Ë—', 'Û”', 'â€', 'â€‘', 'â€’', 'â€“', 'âƒ', 'âˆ’', 'â–', 'â²º', 'ï¹˜'],
    '.': ['Ù ', 'Û°', 'Ü', 'Ü‚', 'â€¤', 'ê“¸', 'ê˜', 'ï¼', 'ğ©', 'ğ…­'],
    '/': ['áœµ', 'â', 'â„', 'âˆ•', 'â•±', 'âŸ‹', 'â§¸', 'â³†', 'â¼ƒ', 'ã€³', 'ãƒ', 'ã‡“', 'ä¸¿', 'ï¼', 'ğˆº'],
    '2': ['Æ§', 'Ï¨', 'á’¿', 'ê™„', 'ê›¯', 'êš', 'ï¼’', 'ğŸ', 'ğŸš', 'ğŸ¤', 'ğŸ®', 'ğŸ¸', '\U0001fbf2'],
    '3': ['Æ·', 'Èœ', 'Ğ—', 'Ó ', 'â³Œ', 'êª', 'ê«', 'ï¼“', 'ğ‘£Š', 'ğ–¼»', 'ğˆ†', 'ğŸ‘', 'ğŸ›', 'ğŸ¥', 'ğŸ¯', 'ğŸ¹', '\U0001fbf3'],
    '4': ['á', 'ï¼”', 'ğ‘¢¯', 'ğŸ’', 'ğŸœ', 'ğŸ¦', 'ğŸ°', 'ğŸº', '\U0001fbf4'],
    '5': ['Æ¼', 'ï¼•', 'ğ‘¢»', 'ğŸ“', 'ğŸ', 'ğŸ§', 'ğŸ±', 'ğŸ»', '\U0001fbf5'],
    '6': ['Ğ±', 'á®', 'â³’', 'ï¼–', 'ğ‘£•', 'ğŸ”', 'ğŸ', 'ğŸ¨', 'ğŸ²', 'ğŸ¼', '\U0001fbf6'],
    '7': ['ï¼—', 'ğ“’', 'ğ‘£†', 'ğˆ’', 'ğŸ•', 'ğŸŸ', 'ğŸ©', 'ğŸ³', 'ğŸ½', '\U0001fbf7'],
    '8': ['È¢', 'È£', 'à§ª', 'à©ª', 'à¬ƒ', 'ï¼˜', 'ğŒš', 'ğŸ–', 'ğŸ ', 'ğŸª', 'ğŸ´', 'ğŸ¾', 'ğ£‹', '\U0001fbf8'],
    '9': ['à§­', 'à©§', 'à­¨', 'àµ­', 'â³Š', 'ê®', 'ï¼™', 'ğ‘¢¬', 'ğ‘£Œ', 'ğ‘£–', 'ğŸ—', 'ğŸ¡', 'ğŸ«', 'ğŸµ', 'ğŸ¿', '\U0001fbf9'],
    ':': ['Ë', 'Ë¸', 'Ö‰', '×ƒ', 'Üƒ', 'Ü„', 'à¤ƒ', 'àªƒ', 'á›¬', 'á ƒ', 'á ‰', 'âš', 'âˆ¶', 'ê“½', 'ê‰', 'ï¸°', 'ï¼š'],
    ';': ['Í¾', 'ï¼›'],
    '<': ['Ë‚', 'á¸', 'áš²', 'â€¹', 'â®', 'ï¼œ', 'ğˆ¶'],
    '=': ['á€', 'â¹€', 'ã‚ ', 'ê“¿', 'ï¼'],
    '>': ['Ëƒ', 'á³', 'â€º', 'â¯', 'ï¼', 'ğ–¼¿', 'ğˆ·'],
    '?': ['É', 'Ê”', 'à¥½', 'á®', 'ê›«', 'ï¼Ÿ'],
    '@': ['ï¼ '],
    'A': ['Î‘', 'Ğ', 'áª', 'á—…', 'á´€', 'ê“®', 'ê­º', 'ï¼¡', 'ğŠ ', 'ğ–½€', 'ğ€', 'ğ´', 'ğ‘¨', 'ğ’œ', 'ğ“', 'ğ”„', 'ğ”¸', 'ğ•¬', 'ğ– ', 'ğ—”', 'ğ˜ˆ', 'ğ˜¼', 'ğ™°', 'ğš¨', 'ğ›¢', 'ğœœ', 'ğ–', 'ğ'],
    'B': ['Ê™', 'Î’', 'Ğ’', 'Ğ²', 'á´', 'á¼', 'á—·', 'á›’', 'â„¬', 'ê“', 'ê´', 'ï¼¢', 'ğŠ‚', 'ğŠ¡', 'ğŒ', 'ğ', 'ğµ', 'ğ‘©', 'ğ“‘', 'ğ”…', 'ğ”¹', 'ğ•­', 'ğ–¡', 'ğ—•', 'ğ˜‰', 'ğ˜½', 'ğ™±', 'ğš©', 'ğ›£', 'ğœ', 'ğ—', 'ğ‘'],
    'C': ['Ï¹', 'Ğ¡', 'áŸ', 'á‘•', 'â„‚', 'â„­', 'â…­', 'âŠ‚', 'â²¤', 'â¸¦', 'ê“š', 'ï¼£', 'ğŠ¢', 'ğŒ‚', 'ğ•', 'ğ”œ', 'ğ‘£©', 'ğ‘£²', 'ğ‚', 'ğ¶', 'ğ‘ª', 'ğ’', 'ğ“’', 'ğ•®', 'ğ–¢', 'ğ—–', 'ğ˜Š', 'ğ˜¾', 'ğ™²', 'ğŸŒ'],
    'D': ['á ', 'á—', 'á—ª', 'á´…', 'â……', 'â…®', 'ê““', 'ê­°', 'ï¼¤', 'ğƒ', 'ğ·', 'ğ‘«', 'ğ’Ÿ', 'ğ““', 'ğ”‡', 'ğ”»', 'ğ•¯', 'ğ–£', 'ğ——', 'ğ˜‹', 'ğ˜¿', 'ğ™³'],
    'E': ['Î•', 'Ğ•', 'á¬', 'á´‡', 'â„°', 'â‹¿', 'â´¹', 'ê“°', 'ê­¼', 'ï¼¥', 'ğŠ†', 'ğ‘¢¦', 'ğ‘¢®', 'ğ„', 'ğ¸', 'ğ‘¬', 'ğ“”', 'ğ”ˆ', 'ğ”¼', 'ğ•°', 'ğ–¤', 'ğ—˜', 'ğ˜Œ', 'ğ™€', 'ğ™´', 'ğš¬', 'ğ›¦', 'ğœ ', 'ğš', 'ğ”'],
    'F': ['Ïœ', 'á–´', 'â„±', 'ê“', 'ê˜', 'ï¼¦', 'ğŠ‡', 'ğŠ¥', 'ğ”¥', 'ğ‘¢¢', 'ğ‘£‚', 'ğˆ“', 'ğ…', 'ğ¹', 'ğ‘­', 'ğ“•', 'ğ”‰', 'ğ”½', 'ğ•±', 'ğ–¥', 'ğ—™', 'ğ˜', 'ğ™', 'ğ™µ', 'ğŸŠ'],
    'G': ['É¢', 'ÔŒ', 'Ô', 'á€', 'á³', 'á»', 'ê“–', 'ê®', 'ï¼§', 'ğ†', 'ğº', 'ğ‘®', 'ğ’¢', 'ğ“–', 'ğ”Š', 'ğ”¾', 'ğ•²', 'ğ–¦', 'ğ—š', 'ğ˜', 'ğ™‚', 'ğ™¶'],
    'H': ['Êœ', 'Î—', 'Ğ', 'Ğ½', 'á»', 'á•¼', 'â„‹', 'â„Œ', 'â„', 'â²', 'ê“§', 'ê®‹', 'ï¼¨', 'ğ‹', 'ğ‡', 'ğ»', 'ğ‘¯', 'ğ“—', 'ğ•³', 'ğ–§', 'ğ—›', 'ğ˜', 'ğ™ƒ', 'ğ™·', 'ğš®', 'ğ›¨', 'ğœ¢', 'ğœ', 'ğ–'],
    'J': ['Í¿', 'Ğˆ', 'á«', 'á’', 'á´Š', 'ê“™', 'ê²', 'ê­»', 'ï¼ª', 'ğ‰', 'ğ½', 'ğ‘±', 'ğ’¥', 'ğ“™', 'ğ”', 'ğ•', 'ğ•µ', 'ğ–©', 'ğ—', 'ğ˜‘', 'ğ™…', 'ğ™¹'],
    'K': ['Îš', 'Ğš', 'á¦', 'á›•', 'â„ª', 'â²”', 'ê“—', 'ï¼«', 'ğ”˜', 'ğŠ', 'ğ¾', 'ğ‘²', 'ğ’¦', 'ğ“š', 'ğ”', 'ğ•‚', 'ğ•¶', 'ğ–ª', 'ğ—', 'ğ˜’', 'ğ™†', 'ğ™º', 'ğš±', 'ğ›«', 'ğœ¥', 'ğŸ', 'ğ™'],
    'L': ['ÊŸ', 'á', 'á’ª', 'â„’', 'â…¬', 'â³', 'â³‘', 'ê“¡', 'ê®®', 'ï¼¬', 'ğ›', 'ğ‘ƒ', 'ğ”¦', 'ğ‘¢£', 'ğ‘¢²', 'ğ–¼–', 'ğˆª', 'ğ‹', 'ğ¿', 'ğ‘³', 'ğ“›', 'ğ”', 'ğ•ƒ', 'ğ•·', 'ğ–«', 'ğ—Ÿ', 'ğ˜“', 'ğ™‡', 'ğ™»'],
    'M': ['Îœ', 'Ïº', 'Ğœ', 'á·', 'á—°', 'á›–', 'â„³', 'â…¯', 'â²˜', 'ê“Ÿ', 'ï¼­', 'ğŠ°', 'ğŒ‘', 'ğŒ', 'ğ‘€', 'ğ‘´', 'ğ“œ', 'ğ”', 'ğ•„', 'ğ•¸', 'ğ–¬', 'ğ— ', 'ğ˜”', 'ğ™ˆ', 'ğ™¼', 'ğš³', 'ğ›­', 'ğœ§', 'ğ¡', 'ğ›'],
    'N': ['É´', 'Î', 'â„•', 'â²š', 'ê“ ', 'ï¼®', 'ğ”“', 'ğ', 'ğ‘', 'ğ‘µ', 'ğ’©', 'ğ“', 'ğ”‘', 'ğ•¹', 'ğ–­', 'ğ—¡', 'ğ˜•', 'ğ™‰', 'ğ™½', 'ğš´', 'ğ›®', 'ğœ¨', 'ğ¢', 'ğœ'],
    'P': ['Î¡', 'Ğ ', 'á¢', 'á‘­', 'á´˜', 'á´©', 'â„™', 'â²¢', 'ê“‘', 'ê®²', 'ï¼°', 'ğŠ•', 'ğ', 'ğ‘ƒ', 'ğ‘·', 'ğ’«', 'ğ“Ÿ', 'ğ”“', 'ğ•»', 'ğ–¯', 'ğ—£', 'ğ˜—', 'ğ™‹', 'ğ™¿', 'ğš¸', 'ğ›²', 'ğœ¬', 'ğ¦', 'ğ '],
    'Q': ['â„š', 'âµ•', 'ï¼±', 'ğ', 'ğ‘„', 'ğ‘¸', 'ğ’¬', 'ğ“ ', 'ğ””', 'ğ•¼', 'ğ–°', 'ğ—¤', 'ğ˜˜', 'ğ™Œ', 'ğš€'],
    'R': ['Æ¦', 'Ê€', 'á¡', 'á’', 'á–‡', 'áš±', 'â„›', 'â„œ', 'â„', 'ê“£', 'ê­±', 'ê®¢', 'ï¼²', 'ğ’´', 'ğ–¼µ', 'ğˆ–', 'ğ‘', 'ğ‘…', 'ğ‘¹', 'ğ“¡', 'ğ•½', 'ğ–±', 'ğ—¥', 'ğ˜™', 'ğ™', 'ğš'],
    'S': ['Ğ…', 'Õ', 'á•', 'áš', 'ê“¢', 'ï¼³', 'ğŠ–', 'ğ ', 'ğ–¼º', 'ğ’', 'ğ‘†', 'ğ‘º', 'ğ’®', 'ğ“¢', 'ğ”–', 'ğ•Š', 'ğ•¾', 'ğ–²', 'ğ—¦', 'ğ˜š', 'ğ™', 'ğš‚'],
    'T': ['Î¤', 'Ï„', 'Ğ¢', 'Ñ‚', 'á¢', 'á´›', 'âŠ¤', 'âŸ™', 'â²¦', 'ê“”', 'ê­²', 'ï¼´', 'ğŠ—', 'ğŠ±', 'ğŒ•', 'ğ‘¢¼', 'ğ–¼Š', 'ğ“', 'ğ‘‡', 'ğ‘»', 'ğ’¯', 'ğ“£', 'ğ”—', 'ğ•‹', 'ğ•¿', 'ğ–³', 'ğ—§', 'ğ˜›', 'ğ™', 'ğšƒ', 'ğš»', 'ğ›•', 'ğ›µ', 'ğœ', 'ğœ¯', 'ğ‰', 'ğ©', 'ğƒ', 'ğ£', 'ğ½', 'ğŸ¨'],
    'U': ['Õ', 'áˆ€', 'á‘Œ', 'âˆª', 'â‹ƒ', 'ê“´', 'ï¼µ', 'ğ“', 'ğ‘¢¸', 'ğ–½‚', 'ğ”', 'ğ‘ˆ', 'ğ‘¼', 'ğ’°', 'ğ“¤', 'ğ”˜', 'ğ•Œ', 'ğ–€', 'ğ–´', 'ğ—¨', 'ğ˜œ', 'ğ™', 'ğš„'],
    'V': ['Ñ´', 'Ù§', 'Û·', 'á™', 'á¯', 'â…¤', 'â´¸', 'ê“¦', 'ê›Ÿ', 'ï¼¶', 'ğ”', 'ğ‘¢ ', 'ğ–¼ˆ', 'ğˆ', 'ğ•', 'ğ‘‰', 'ğ‘½', 'ğ’±', 'ğ“¥', 'ğ”™', 'ğ•', 'ğ–', 'ğ–µ', 'ğ—©', 'ğ˜', 'ğ™‘', 'ğš…'],
    'W': ['Ôœ', 'á³', 'á”', 'ê“ª', 'ï¼·', 'ğ‘£¦', 'ğ‘£¯', 'ğ–', 'ğ‘Š', 'ğ‘¾', 'ğ’²', 'ğ“¦', 'ğ”š', 'ğ•', 'ğ–‚', 'ğ–¶', 'ğ—ª', 'ğ˜', 'ğ™’', 'ğš†'],
    'X': ['Î§', 'Ğ¥', 'á™­', 'áš·', 'â…©', 'â•³', 'â²¬', 'âµ', 'ê“«', 'ê³', 'ï¼¸', 'ğŠ', 'ğŠ´', 'ğŒ—', 'ğŒ¢', 'ğ”§', 'ğ‘£¬', 'ğ—', 'ğ‘‹', 'ğ‘¿', 'ğ’³', 'ğ“§', 'ğ”›', 'ğ•', 'ğ–ƒ', 'ğ–·', 'ğ—«', 'ğ˜Ÿ', 'ğ™“', 'ğš‡', 'ğš¾', 'ğ›¸', 'ğœ²', 'ğ¬', 'ğ¦'],
    'Y': ['Î¥', 'Ï’', 'Ğ£', 'Ò®', 'á©', 'á½', 'â²¨', 'ê“¬', 'ï¼¹', 'ğŠ²', 'ğ‘¢¤', 'ğ–½ƒ', 'ğ˜', 'ğ‘Œ', 'ğ’€', 'ğ’´', 'ğ“¨', 'ğ”œ', 'ğ•', 'ğ–„', 'ğ–¸', 'ğ—¬', 'ğ˜ ', 'ğ™”', 'ğšˆ', 'ğš¼', 'ğ›¶', 'ğœ°', 'ğª', 'ğ¤'],
    'Z': ['Î–', 'áƒ', 'â„¤', 'â„¨', 'ê“œ', 'ï¼º', 'ğ‹µ', 'ğ‘¢©', 'ğ‘£¥', 'ğ™', 'ğ‘', 'ğ’', 'ğ’µ', 'ğ“©', 'ğ–…', 'ğ–¹', 'ğ—­', 'ğ˜¡', 'ğ™•', 'ğš‰', 'ğš­', 'ğ›§', 'ğœ¡', 'ğ›', 'ğ•'],
    '\\': ['âˆ–', 'âŸ', 'â§µ', 'â§¹', 'â¼‚', 'ã‡”', 'ä¸¶', 'ï¹¨', 'ï¼¼', 'ğˆ', 'ğˆ»'],
    '^': ['Ë„', 'Ë†'],
    '_': ['ßº', 'ï¹', 'ï¹', 'ï¹', 'ï¼¿'],
    'a': ['É‘', 'Î±', 'Ğ°', 'âº', 'ï½', 'ğš', 'ğ‘', 'ğ’‚', 'ğ’¶', 'ğ“ª', 'ğ”', 'ğ•’', 'ğ–†', 'ğ–º', 'ğ—®', 'ğ˜¢', 'ğ™–', 'ğšŠ', 'ğ›‚', 'ğ›¼', 'ğœ¶', 'ğ°', 'ğª'],
    'b': ['Æ„', 'Ğ¬', 'á', 'á‘²', 'á–¯', 'ï½‚', 'ğ›', 'ğ‘', 'ğ’ƒ', 'ğ’·', 'ğ“«', 'ğ”Ÿ', 'ğ•“', 'ğ–‡', 'ğ–»', 'ğ—¯', 'ğ˜£', 'ğ™—', 'ğš‹'],
    'c': ['Ï²', 'Ñ', 'á´„', 'â…½', 'â²¥', 'ê®¯', 'ï½ƒ', 'ğ½', 'ğœ', 'ğ‘', 'ğ’„', 'ğ’¸', 'ğ“¬', 'ğ” ', 'ğ•”', 'ğ–ˆ', 'ğ–¼', 'ğ—°', 'ğ˜¤', 'ğ™˜', 'ğšŒ'],
    'd': ['Ô', 'á§', 'á‘¯', 'â…†', 'â…¾', 'ê“’', 'ï½„', 'ğ', 'ğ‘‘', 'ğ’…', 'ğ’¹', 'ğ“­', 'ğ”¡', 'ğ••', 'ğ–‰', 'ğ–½', 'ğ—±', 'ğ˜¥', 'ğ™™', 'ğš'],
    'e': ['Ğµ', 'Ò½', 'â„®', 'â„¯', 'â…‡', 'ê¬²', 'ï½…', 'ğ', 'ğ‘’', 'ğ’†', 'ğ“®', 'ğ”¢', 'ğ•–', 'ğ–Š', 'ğ–¾', 'ğ—²', 'ğ˜¦', 'ğ™š', 'ğš'],
    'f': ['Å¿', 'Ï', 'Ö„', 'áº', 'ê™', 'ê¬µ', 'ï½†', 'ğŸ', 'ğ‘“', 'ğ’‡', 'ğ’»', 'ğ“¯', 'ğ”£', 'ğ•—', 'ğ–‹', 'ğ–¿', 'ğ—³', 'ğ˜§', 'ğ™›', 'ğš', 'ğŸ‹'],
    'g': ['Æ', 'É¡', 'Ö', 'á¶ƒ', 'â„Š', 'ï½‡', 'ğ ', 'ğ‘”', 'ğ’ˆ', 'ğ“°', 'ğ”¤', 'ğ•˜', 'ğ–Œ', 'ğ—€', 'ğ—´', 'ğ˜¨', 'ğ™œ', 'ğš'],
    'h': ['Ò»', 'Õ°', 'á‚', 'â„', 'ï½ˆ', 'ğ¡', 'ğ’‰', 'ğ’½', 'ğ“±', 'ğ”¥', 'ğ•™', 'ğ–', 'ğ—', 'ğ—µ', 'ğ˜©', 'ğ™', 'ğš‘'],
    'i': ['Ä±', 'É©', 'Éª', 'Ë›', 'Íº', 'Î¹', 'Ñ–', 'Ó', 'á¥', 'á¾¾', 'â„¹', 'â…ˆ', 'â…°', 'â³', 'ê™‡', 'ê­µ', 'ï½‰', 'ğ‘£ƒ', 'ğ¢', 'ğ‘–', 'ğ’Š', 'ğ’¾', 'ğ“²', 'ğ”¦', 'ğ•š', 'ğ–', 'ğ—‚', 'ğ—¶', 'ğ˜ª', 'ğ™', 'ğš’', 'ğš¤', 'ğ›Š', 'ğœ„', 'ğœ¾', 'ğ¸', 'ğ²'],
    'j': ['Ï³', 'Ñ˜', 'â…‰', 'ï½Š', 'ğ£', 'ğ‘—', 'ğ’‹', 'ğ’¿', 'ğ“³', 'ğ”§', 'ğ•›', 'ğ–', 'ğ—ƒ', 'ğ—·', 'ğ˜«', 'ğ™Ÿ', 'ğš“'],
    'k': ['ï½‹', 'ğ¤', 'ğ‘˜', 'ğ’Œ', 'ğ“€', 'ğ“´', 'ğ”¨', 'ğ•œ', 'ğ–', 'ğ—„', 'ğ—¸', 'ğ˜¬', 'ğ™ ', 'ğš”'],
    'l': ['Æ–', 'Ç€', 'Î™', 'Ğ†', 'Ó€', '×€', '×•', '×Ÿ', 'Ø§', 'Ù¡', 'Û±', 'ßŠ', 'á›', 'â„', 'â„‘', 'â„“', 'â… ', 'â…¼', 'âˆ£', 'â½', 'â²’', 'âµ', 'ê“²', 'ïº', 'ïº', 'ï¼‘', 'ï¼©', 'ï½Œ', 'ï¿¨', 'ğŠŠ', 'ğŒ‰', 'ğŒ ', 'ğ–¼¨', 'ğˆ', 'ğ¥', 'ğ¼', 'ğ‘™', 'ğ‘°', 'ğ’', 'ğ“', 'ğ“˜', 'ğ“µ', 'ğ”©', 'ğ•€', 'ğ•', 'ğ•´', 'ğ–‘', 'ğ–¨', 'ğ—…', 'ğ—œ', 'ğ—¹', 'ğ˜', 'ğ˜­', 'ğ™„', 'ğ™¡', 'ğ™¸', 'ğš•', 'ğš°', 'ğ›ª', 'ğœ¤', 'ğ', 'ğ˜', 'ğŸ', 'ğŸ™', 'ğŸ£', 'ğŸ­', 'ğŸ·', 'ğ£‡', 'ğ¸€', 'ğº€', '\U0001fbf1'],
    'm': ['ï½'],
    'n': ['Õ¸', 'Õ¼', 'ï½', 'ğ§', 'ğ‘›', 'ğ’', 'ğ“ƒ', 'ğ“·', 'ğ”«', 'ğ•Ÿ', 'ğ–“', 'ğ—‡', 'ğ—»', 'ğ˜¯', 'ğ™£', 'ğš—'],
    'o': ['ÎŸ', 'Î¿', 'Ïƒ', 'Ğ', 'Ğ¾', 'Õ•', 'Ö…', '×¡', 'Ù‡', 'Ù¥', 'Ú¾', 'Û', 'Û•', 'Ûµ', 'ß€', 'à¥¦', 'à§¦', 'à©¦', 'à«¦', 'à¬ ', 'à­¦', 'à¯¦', 'à°‚', 'à±¦', 'à²‚', 'à³¦', 'à´‚', 'à´ ', 'àµ¦', 'à¶‚', 'à¹', 'à»', 'á€', 'á€', 'áƒ¿', 'á‹', 'á´', 'á´‘', 'â„´', 'â²', 'â²Ÿ', 'âµ”', 'ã€‡', 'ê“³', 'ê¬½', 'ï®¦', 'ï®§', 'ï®¨', 'ï®©', 'ï®ª', 'ï®«', 'ï®¬', 'ï®­', 'ï»©', 'ï»ª', 'ï»«', 'ï»¬', 'ï¼', 'ï¼¯', 'ï½', 'ğŠ’', 'ğŠ«', 'ğ„', 'ğ¬', 'ğ“‚', 'ğ“ª', 'ğ”–', 'ğ‘“', 'ğ‘¢µ', 'ğ‘£ˆ', 'ğ‘£—', 'ğ‘£ ', 'ğ', 'ğ¨', 'ğ‘‚', 'ğ‘œ', 'ğ‘¶', 'ğ’', 'ğ’ª', 'ğ“', 'ğ“¸', 'ğ”’', 'ğ”¬', 'ğ•†', 'ğ• ', 'ğ•º', 'ğ–”', 'ğ–®', 'ğ—ˆ', 'ğ—¢', 'ğ—¼', 'ğ˜–', 'ğ˜°', 'ğ™Š', 'ğ™¤', 'ğ™¾', 'ğš˜', 'ğš¶', 'ğ›', 'ğ›”', 'ğ›°', 'ğœŠ', 'ğœ', 'ğœª', 'ğ„', 'ğˆ', 'ğ¤', 'ğ¾', 'ğ‚', 'ğ', 'ğ¸', 'ğ¼', 'ğŸ', 'ğŸ˜', 'ğŸ¢', 'ğŸ¬', 'ğŸ¶', 'ğ¸¤', 'ğ¹¤', 'ğº„', '\U0001fbf0'],
    'p': ['Ï', 'Ï±', 'Ñ€', 'â´', 'â²£', 'ï½', 'ğ©', 'ğ‘', 'ğ’‘', 'ğ“…', 'ğ“¹', 'ğ”­', 'ğ•¡', 'ğ–•', 'ğ—‰', 'ğ—½', 'ğ˜±', 'ğ™¥', 'ğš™', 'ğ›’', 'ğ› ', 'ğœŒ', 'ğœš', 'ğ†', 'ğ”', 'ğ€', 'ğ', 'ğº', 'ğŸˆ'],
    'q': ['Ô›', 'Õ£', 'Õ¦', 'ï½‘', 'ğª', 'ğ‘', 'ğ’’', 'ğ“†', 'ğ“º', 'ğ”®', 'ğ•¢', 'ğ––', 'ğ—Š', 'ğ—¾', 'ğ˜²', 'ğ™¦', 'ğšš'],
    'r': ['Ğ³', 'á´¦', 'â²…', 'ê­‡', 'ê­ˆ', 'ê®', 'ï½’', 'ğ«', 'ğ‘Ÿ', 'ğ’“', 'ğ“‡', 'ğ“»', 'ğ”¯', 'ğ•£', 'ğ–—', 'ğ—‹', 'ğ—¿', 'ğ˜³', 'ğ™§', 'ğš›'],
    's': ['Æ½', 'Ñ•', 'êœ±', 'ê®ª', 'ï½“', 'ğ‘ˆ', 'ğ‘£', 'ğ¬', 'ğ‘ ', 'ğ’”', 'ğ“ˆ', 'ğ“¼', 'ğ”°', 'ğ•¤', 'ğ–˜', 'ğ—Œ', 'ğ˜€', 'ğ˜´', 'ğ™¨', 'ğšœ'],
    't': ['ï½”', 'ğ­', 'ğ‘¡', 'ğ’•', 'ğ“‰', 'ğ“½', 'ğ”±', 'ğ•¥', 'ğ–™', 'ğ—', 'ğ˜', 'ğ˜µ', 'ğ™©', 'ğš'],
    'u': ['Ê‹', 'Ï…', 'Õ½', 'á´œ', 'êŸ', 'ê­', 'ê­’', 'ï½•', 'ğ“¶', 'ğ‘£˜', 'ğ®', 'ğ‘¢', 'ğ’–', 'ğ“Š', 'ğ“¾', 'ğ”²', 'ğ•¦', 'ğ–š', 'ğ—', 'ğ˜‚', 'ğ˜¶', 'ğ™ª', 'ğš', 'ğ›–', 'ğœ', 'ğŠ', 'ğ„', 'ğ¾'],
    'v': ['Î½', 'Ñµ', '×˜', 'á´ ', 'â…´', 'âˆ¨', 'â‹', 'ê®©', 'ï½–', 'ğ‘œ†', 'ğ‘£€', 'ğ¯', 'ğ‘£', 'ğ’—', 'ğ“‹', 'ğ“¿', 'ğ”³', 'ğ•§', 'ğ–›', 'ğ—', 'ğ˜ƒ', 'ğ˜·', 'ğ™«', 'ğšŸ', 'ğ›', 'ğœˆ', 'ğ‚', 'ğ¼', 'ğ¶'],
    'w': ['É¯', 'Ñ¡', 'Ô', 'Õ¡', 'á´¡', 'ê®ƒ', 'ï½—', 'ğ‘œŠ', 'ğ‘œ', 'ğ‘œ', 'ğ°', 'ğ‘¤', 'ğ’˜', 'ğ“Œ', 'ğ”€', 'ğ”´', 'ğ•¨', 'ğ–œ', 'ğ—', 'ğ˜„', 'ğ˜¸', 'ğ™¬', 'ğš '],
    'x': ['Ã—', 'Ñ…', 'á•', 'á•½', 'á™®', 'â…¹', 'â¤«', 'â¤¬', 'â¨¯', 'ï½˜', 'ğ±', 'ğ‘¥', 'ğ’™', 'ğ“', 'ğ”', 'ğ”µ', 'ğ•©', 'ğ–', 'ğ—‘', 'ğ˜…', 'ğ˜¹', 'ğ™­', 'ğš¡'],
    'y': ['É£', 'Ê', 'Î³', 'Ñƒ', 'Ò¯', 'áƒ§', 'á¶Œ', 'á»¿', 'â„½', 'ê­š', 'ï½™', 'ğ‘£œ', 'ğ²', 'ğ‘¦', 'ğ’š', 'ğ“', 'ğ”‚', 'ğ”¶', 'ğ•ª', 'ğ–', 'ğ—’', 'ğ˜†', 'ğ˜º', 'ğ™®', 'ğš¢', 'ğ›„', 'ğ›¾', 'ğœ¸', 'ğ²', 'ğ¬'],
    'z': ['á´¢', 'ê®“', 'ï½š', 'ğ‘£„', 'ğ³', 'ğ‘§', 'ğ’›', 'ğ“', 'ğ”ƒ', 'ğ”·', 'ğ•«', 'ğ–Ÿ', 'ğ—“', 'ğ˜‡', 'ğ˜»', 'ğ™¯', 'ğš£'],
    '{': ['â´', 'ï½›', 'ğ„”'],
    '}': ['âµ', 'ï½'],
    '~': ['Ëœ', 'á¿€', 'â“', 'âˆ¼'],
}

markers = ['\n_START_ARTICLE_\n', '\n_START_SECTION_\n', '\n_START_PARAGRAPH_\n', '_NEWLINE_']
specials = ['\u008A', '\u008B', '\u008C', '\u008D']
unk = '\u008E'


def lowercase(text):
    return text.lower()


def collapse_whitespace(text):
    _whitespace_re = re.compile(r'\s+')
    return re.sub(_whitespace_re, ' ', text)


def process_homoglyphs(text):
    for a, b in homoglyphs.items():
        for c in b:
            text = text.replace(c, a)

    return text


mapping = {}
base_path = 'data/wiki40b/'
threshold = 5
n_chunks = 32

language = sys.argv[1]
assert len(language)

for split in ['train', 'validation', 'test']:
    dataset = os.path.join(base_path, language, f'{split}.raw.txt')

    with open(dataset, 'r+') as file:
        text = file.read()

    for sp in specials:
        assert sp not in text

    for marker, special in zip(markers, specials):
        text = text.replace(marker, f' {special} ')

    text = text.replace(unk, ' ')

    text = lowercase(text)
    text = collapse_whitespace(text)
    text = text.strip()

    assert unk not in text

    if split == 'train':
        counter = Counter(text)
        allowed_chars = [k for k, v in counter.items() if v > threshold]

    print('Changing unknowns')

    # After I add homoglyphs remember to collapse unknonws

    chunk_len = (len(text) + n_chunks - 1) // n_chunks
    splitted_text = [text[i:i + chunk_len] for i in range(0, len(text), chunk_len)]

    def change_unks(txt):
        for idx, key in enumerate(counter.keys()):
            if key not in allowed_chars:
                txt = txt.replace(key, unk)
        return txt

    with Pool(n_chunks) as p:
        text = ''.join(p.imap(change_unks, splitted_text))

    os.makedirs(os.path.dirname(f'{base_path}{language}'), exist_ok=True)

    filename = f'{base_path}{language}/{split}.txt'

    print('Writing the file')

    with open(filename, 'w+') as file:
        file.write(text)
